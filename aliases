#!/bin/bash
alias toClipBoard="xclip -i -selection clipboard"
alias ssh="ssh -v"
alias dc="docker-compose"
alias dcd="docker-compose -f docker-compose-dev.yml"
alias workspace="cd ~/workspace"
alias dockerStopAll="docker stop \$(docker ps -a -q)";
alias dockerRmAll="docker rm \$(docker ps -a -q)";
alias dockerRmVolumes="docker volume rm \`docker volume ls -q -f dangling=true\`"
alias dockerRmConsul="sudo rm -rf /consul/*"
alias dockerRmDanglingImages="docker rmi \$(docker images -aq --filter dangling=true)"
alias dockerCleanUp="dockerRmConsul; dockerStopAll; dockerRmAll; dockerRmVolumes; dockerRmDanglingImages"
alias listLargeFiles="sudo du -h / 2>/dev/null | grep '[0-9\.]\+G'"
alias startDocker="sudo service docker start"
alias gcob="git checkout -b"
alias gco="git checkout"
alias gcot="git checkout --theirs"
alias gom="git checkout master; git pull origin master"
alias grm="branchName=\`git rev-parse --abbrev-ref HEAD\`; gom; git checkout \$branchName; git rebase -i master";
alias gma="git rebase --abort";
alias gpo="branchName=\`git rev-parse --abbrev-ref HEAD\`; git push origin \$branchName";
alias gpu="branchName=\`git rev-parse --abbrev-ref HEAD\`; git pull origin \$branchName";
alias gst="git status"
alias gd="git diff"
alias gau="git add -u"
alias ga="git add"
alias gai="git add -i"
alias gc="git commit"
alias gss="git stash save"
alias gsp="git stash pop"
alias gsa="git stash apply"
alias gp="branchName=\`git rev-parse --abbrev-ref HEAD\`; git pull origin \$branchName;"
alias grc="git rebase --continue"
alias gra="git rebase --abort"
alias gr="git reset ."
alias grh="git reset HEAD "
alias gruf="git clean -fd"
alias ghr="branchName=\`git rev-parse --abbrev-ref HEAD\`; git fetch origin; git reset --hard \$branchName"
alias aliases="cat ~/.aliases"
alias gitPassword="secret-tool search --all unique ssh-store:/home/smoky/.ssh/github_rsa 2>/dev/null | awk ' /secret =/ { print \$3; exit; } ' | toClipBoard; ssh-add ~/.ssh/github_rsa"
alias runTests="dc -f docker-compose-dev.yml run test"
alias runRedis="docker run --name redis -p 6379:6379 -d redis:3.0.7"
alias cleanDNS="sudo /etc/init.d/dns-clean restart; sudo systemd-resolve --flush-caches";
alias useGoogleDNS="echo \"nameserver 8.8.8.8\" | sudo tee /etc/resolv.conf > /dev/null; cleanDNS"
alias useAWSDNS="echo \"nameserver 172.16.0.23\" | sudo tee /etc/resolv.conf > /dev/null; cleanDNS"
alias changeHosts="sudo vim /etc/hosts"
alias reloadSource="source ~/.zshrc"
alias colours="for i in {0..255}; do printf \"\\x1b[38;5;\${i}mcolour\${i}\\x1b[0m \"; done";
alias startVBoxService="sudo systemctl start vboxdrv.service"
alias ..="cd .."

function currentBranch() {
    echo `git rev-parse --abbrev-ref HEAD`
}

function diffProviders() {
    branch=`currentBranch`
    x=`cat providers.ini.enc | docker run -i talis/nema:latest /nema -decrypt -key $LOGIN_CONFIG_PROD_SECRET`
    gco master >/dev/null 2>&1
    gpo >/dev/null 2>&1
    y=`cat providers.ini.enc | docker run -i talis/nema:latest /nema -decrypt -key $LOGIN_CONFIG_PROD_SECRET`
    gco $branch >/dev/null 2>&1
    diff <(echo $x) <(echo $y)
}

function diffIdps() {
    branch=`currentBranch`
    x=`cat idps.json.enc | docker run -i talis/nema:latest /nema -decrypt -key $LOGIN_CONFIG_PROD_SECRET`
    gco master >/dev/null 2>&1
    gpo >/dev/null 2>&1
    y=`cat idps.json.enc | docker run -i talis/nema:latest /nema -decrypt -key $LOGIN_CONFIG_PROD_SECRET`
    gco $branch >/dev/null 2>&1
    diff <(echo $x) <(echo $y)
}
